#  純PHP製 ChatGPT風チャットボット

## プロジェクト概要
このリポジトリは、**「ChatGPTっぽさ」を純粋に PHP だけで再現**したチャットボットのサンプルです。  
JavaScript や外部ライブラリを一切使わず、PHP の if/preg_match・セッション管理・ファイルI/O のみで動作します。  
“考え中…” 演出や、キーワード抽出による文脈参照などの工夫を盛り込み、  
あたかも AI のように見えるように仕上げています。

- **技術スタック**：
    - PHP (8.0 以上推奨)
    - セッション（`$_SESSION`）
    - ファイル操作 (`file_put_contents` + `LOCK_EX`)
    - 純粋な HTML/CSS（最低限のスタイル）

- **動作イメージ**：
    1. ブラウザでアクセス
    2. 「こんにちは」などの挨拶を送信
    3. 画面上に “考え中…” が表示され、0.5秒後に返答が返ってくる
    4. 「映画」「PHP」などのキーワードを含めると、自動でトピックを蓄積し、次の返答で文脈を拾ってくれる
    5. `?reset=1` を付与すると会話履歴とトピックはリセットされるが、全端末共通のログファイルには会話記録が残る

---

##  主な機能
1. **純PHPルールベース応答**
    - ざっくり「挨拶」「自己紹介」「感謝」「さようなら」「感情表現」「疑問文」「その他」の７カテゴリ判定を行い、  
      各カテゴリ毎に複数の返答パターンからランダムで選択。
2. **キーワード抽出＆文脈参照**
    - 「映画」「音楽」「PHP」「Laravel」「AI」「旅行」などを簡易的に抽出し、  
      セッションに蓄積。
    - “その他” カテゴリのテンプレートにランダム返答＋最後に「ちなみに、△△についてはどう思いますか？」を付加し、会話に“流れ”を作る。
3. **“考え中…” 演出**
    - 応答を返す前に一度画面上に「 ボット: …考え中…」を表示し、`usleep(500000)` で 0.5秒待機することで、  
      あたかもサーバーで重い処理をしているように見せかける。
4. **全会話ログをファイルに追記**
    - どの端末からアクセスしても同じ `chat_log.txt` に `[YYYY-MM-DD HH:MM:SS] USER: 〜 → BOT: 〜` 形式で追記。
    - これにより、複数端末のやり取りを一箇所に保存できる。
5. **会話履歴とトピックはセッション管理**
    - ブラウザごとに別セッションのため、端末ごとに独立した会話履歴を表示。
    - 必要があれば `?reset=1` でセッションとトピックをクリアし、新しい会話を開始できる。

---

##  技術スタック
- **PHP 本体（8.0 以上 推奨）**
    - if / preg_match を使った簡易ルールベース応答
    - `session_start()` による会話履歴・トピック保存
    - `file_put_contents(..., FILE_APPEND | LOCK_EX)` による排他ロック付きファイル追記
    - `usleep(500000)` による“考え中演出”
- **HTML/CSS（最低限）**
    - PHP スクリプト内に直接書かれたシンプルなマークアップ
    - インライン CSS で最低限のボックスデザインとマージン調整
- **動作環境**
    - PHP ビルトインサーバーでも OK (`php -S 0.0.0.0:8000`)
    - Apache / Nginx + PHP-FPM でも問題なく動作

---

## 📥 インストール＆起動方法

1. リポジトリをクローン・ローカルに配置
   ```bash
   git clone https://github.com/tamai-hideyuki/chat-php-gpt.git
   cd chat-php-gpt
    ```
   
2. PHP のビルトインサーバーで起動（0.0.0.0 を指定すれば同一LAN内からもアクセス可能
```
php -S 0.0.0.0:8000
```

3. ブラウザで下記URLにアクセス
```
http://<あなたのPCのIPアドレス or localhost>:8000/index.php
```

## 🎯 使い方のコツ
1. **まずは挨拶から**  

 >「こんにちは」「おはよう」などで運転席を温めると、ボットも自然に返してくれます。

2. **「？」を文末につけると質問カテゴリとして応答**

>「PHP と Laravel の違いは？」など、疑問符を活用しましょう。

3. **キーワードを含めてみる**

>「映画を観た」「PHP の勉強をしてる」などを送ると、「映画」「PHP」というキーワードを拾い、
「ちなみに、『映画』の話題についてはどう思いますか？」のように文脈を広げてくれます。

4. **感情・体調を入れると共感返し**

>「疲れた」「元気ない」などを送ると、「気分の波ってありますよね。無理せずいきましょう。」
といった共感系の返答をしてくれます。

5. **会話をリセットしたいときは「 会話をリセット」をクリック**

>セッションとトピックがクリアされ、まっさらな状態に戻ります。
ただしファイル chat_log.txt には過去の会話がすべて残り続けます。

## 構造
```
chat-php-gpt/
├── index.php         ← コア実装（ルールベース応答 + セッション管理 + ログ出力）
├── chat_log.txt      ← 全端末共通の追記ログファイル（タイムスタンプ＋USER/BOT）
└── README.md         ← 本ドキュメント
```

### Happy PHP Chatting!
